De la misma forma que todos los paquetes de datos en la capa Ethernet tienen por nombre específico tramas de Ethernet, también lo tienen los paquetes en la capa de red. En virtud del protocolo IP, a un paquete se lo conoce, por lo general, como un datagrama IP. Al igual que cualquier trama de Ethernet, un datagrama IP es una serie de campos altamente estructurados que están estrictamente definidos. Las dos secciones principales de un datagrama IP son el encabezado y la carga útil.

Podrás notar que un encabezado de datagrama IP contiene muchos más datos que un encabezado de trama de Ethernet. El primer campo es de 4 bits, e indica qué versión de protocolo de Internet se está utilizando. La versión más común de IP es la versión cuatro o IPv4. La versión seis o IPv6 está siendo adoptada rápidamente de forma generalizada, pero esto lo veremos en un módulo posterior.

Después del campo de versión, tenemos el campo de longitud de encabezado. Este también es un campo de 4 bits que muestra qué tan largo es todo el encabezado. Casi siempre tiene una longitud de 20 bytes cuando se trata de IPv4. De hecho, 20 bytes es la longitud mínima de un encabezado IP. No sería posible acomodar todos los datos necesarios de un encabezado IP correctamente formateado en un espacio menor.

A continuación, tenemos el campo Tipo de servicio. Estos 8 bits pueden usarse para especificar detalles sobre la calidad de servicio o las tecnologías QoS. Lo importante de la QoS es que hay servicios que permiten a los routers tomar decisiones sobre qué datagrama IP puede ser más importante que otros.

El siguiente campo es un campo de 16 bits, conocido como el campo Longitud total. Se utiliza exactamente para lo que suena: para indicar la longitud total del datagrama IP al que está asociado.

El campo de identificación es un número de 16 bits que se utiliza para agrupar mensajes. Los datagramas IP tienen un tamaño máximo, y es posible que a estas alturas ya sepas cuál es. Dado que el campo Longitud total es de 16 bits, y este campo indica el tamaño de un datagrama individual, el tamaño máximo de un solo datagrama es el número más grande que se puede representar con 16 bits: 65,535. Si la cantidad total de datos que debe enviarse es más grande de lo que puede caber en un solo datagrama, la capa IP necesitará dividir estos datos en muchos paquetes individuales. Cuando esto sucede, el campo de identificación se utiliza para que el extremo receptor entienda que cada paquete con el mismo valor en ese campo es parte de la misma transmisión.

A continuación, tenemos dos campos estrechamente relacionados. El campo Indicador y el campo Desplazamiento de fragmentación. El campo Indicador se utiliza para indicar si un datagrama puede fragmentarse, o para indicar que el datagrama ya fue fragmentado. La fragmentación es el proceso de tomar un solo datagrama IP y dividirlo en varios datagramas más pequeños. Si bien la mayoría de las redes operan con configuraciones similares en términos de cuál es el tamaño permitido para un datagrama IP, en algunas ocasiones podría haber configuraciones diferentes. Si un datagrama tiene que cruzar desde una red que permite un datagrama de mayor tamaño a otra red con un menor tamaño de datagrama, se deberá fragmentar el datagrama en otros más pequeños. El campo Desplazamiento de fragmentación contiene valores utilizados por el extremo receptor para tomar todas las partes de un paquete fragmentado y reunirlos en el orden correcto.

Avancemos hacia el campo Tiempo de vida o TTL. Este campo es un campo de 8 bits que indica cuántos saltos de router puede cruzar un datagrama antes de ser desechado. Cada vez que un datagrama llega a un nuevo router, dicho router disminuye el campo TTL en una unidad. Una vez que este valor llega a cero, el router sabe que no tiene que reenviar más el datagrama. El objetivo principal de este campo es asegurarse de que cuando haya un error de configuración en el enrutamiento que cause un bucle sin fin, los datagramas no se queden toda la eternidad tratando de llegar a su destino. Un bucle sin fin podría ser cuando el router A piensa que el router B es el siguiente salto, y el router B piensa que el router A es el siguiente salto; mala señal. En un próximo módulo, aprenderás que el campo TTL tiene cualidades valiosas para la resolución de problemas, pero los secretos como estos solo se revelan a quienes perseveran.

Después del campo TTL, encontrarás el campo Protocolo. Este es otro campo de 8 bits que contiene datos sobre qué protocolo de capa de transporte se está usando. Los protocolos de capa de transporte más comunes son TCP y UDP, y veremos ambos en detalle en las siguientes lecciones.

A continuación, encontramos el campo Suma de verificación de encabezado. Este campo es una suma de verificación del contenido de todo el encabezado del datagrama IP. Funciona de manera muy similar al campo de suma de verificación de Ethernet que analizamos en el último módulo. Dado que el campo TTL debe recalcularse en cada router que toque un datagrama, el campo Suma de verificación también cambia obligatoriamente.

Después de todo eso, finalmente llegamos a dos campos muy importantes, los campos de las direcciones IP de origen y de destino. Recuerda que una dirección IP es un número de 32 bits, por lo que no debería sorprenderte que estos campos tengan una longitud de 32 bits.

A continuación, tenemos el campo Opciones de IP. Este es un campo opcional y se utiliza para establecer características especiales para datagramas usados principalmente con fines de prueba. El campo Opciones de IP suele ir seguido de un campo de relleno. Dado que el campo Opciones de IP es opcional y de longitud variable, el campo de relleno es solo una serie de ceros utilizados para asegurarse de que el encabezado tenga el tamaño total indicado.

Ahora que conoces todas las partes de un datagrama IP, podrías preguntarte cómo se relaciona todo esto con lo que aprendimos hasta ahora. Quizás recuerdes que en nuestro desglose de una trama de Ethernet mencionamos una sección que describimos como la sección de carga útil de datos. Un datagrama IP es exactamente esto, y este proceso se conoce como encapsulación. Todo el contenido de un datagrama IP se encapsula como la carga útil de una trama Ethernet. Tal vez hayas notado que nuestro datagrama IP también tiene una sección de carga útil. El contenido de esta carga útil es la totalidad de un paquete TCP o UDP, los cuales veremos más adelante. Con suerte, esto te ayudará a entender mejor la razón por la que hablamos de redes en términos de capas. Cada capa es necesaria para la anterior.